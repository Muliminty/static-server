import{r as c,j as e}from"./index-main-or1qZ--d.js";import{D as S,I as C,V as q,P as d,g as D}from"./memos-DLaNlAmA.js";import{M as R}from"./index-CWHgbzdw.js";/* empty css                */import"./apiConfig-CciPcZ7e.js";import"./NotionImageRenderer-CvVGTY1v.js";const E="_feedContainer_1s8yu_2",G="_content_1s8yu_12",H="_header_1s8yu_30",L="_postCard_1s8yu_51",P="_avatar_1s8yu_64",V="_postContent_1s8yu_71",T="_username_1s8yu_78",z="_timestamp_1s8yu_88",Y="_imageGrid_1s8yu_99",$="_thumbnail_1s8yu_106",A="_animation_1s8yu_181",O="_fadeIn_1s8yu_1",a={feedContainer:E,content:G,header:H,postCard:L,avatar:P,postContent:V,username:T,timestamp:z,imageGrid:Y,thumbnail:$,"drawer-view-all":"_drawer-view-all_1s8yu_114","drawer-view-all-content":"_drawer-view-all-content_1s8yu_119",animation:A,fadeIn:O},U=()=>{const[r,l]=c.useState([]),[w,m]=c.useState(!1),[n,p]=c.useState({}),u=c.useRef([]),t=window.innerHeight-24,v=()=>m(!0),_=()=>m(!1);return c.useEffect(()=>{(async()=>{const g=(await D()).data.map(i=>(i.data.images&&(i.data.images=i.data.images.map(f=>{const h=f.replace("../","");return console.log("v: ",h),`https://github.com/Muliminty/memos-database/blob/main/${h}?raw=true`})),i))||[];l([0,...g])})()},[]),e.jsxs("div",{className:a.feedContainer,children:[e.jsxs(S,{rootClassName:a["drawer-view-all"],title:"è¯¦æƒ…",placement:"bottom",width:375,height:window.innerHeight*.9,onClose:_,open:w,children:[e.jsxs("div",{className:a["drawer-view-all-content"],onClick:s=>{!["ant-image-mask","ant-image-preview-img","ant-image-preview-wrap","ant-image-mask-info"].includes(s.target.className)&&!s.target.className.includes("MarkdownRenderer")&&!s.target.className.includes("imageGrid")&&_()},children:[e.jsx(R,{data:n.content}),(n==null?void 0:n.images)&&e.jsx(C.PreviewGroup,{items:n.images,children:e.jsx("div",{className:a.imageGrid,children:n.images.map((s,o)=>e.jsx(C,{src:`${s}`},o))})})]}),e.jsx("div",{children:n.date})]}),e.jsx("div",{className:a.content,children:e.jsx(q,{height:t,itemCount:r.length,itemSize:s=>130,width:"100%",children:({index:s,style:o})=>e.jsx(N,{index:s,style:o,posts:r,itemRefs:u,setSelectedPost:p,showDrawer:v})})})]})},N=({index:r,style:l,posts:w,itemRefs:m,setSelectedPost:n,showDrawer:p})=>{var o,g;const u=c.useRef(null),t=(o=w[r])==null?void 0:o.data,v=((g=t==null?void 0:t.images)==null?void 0:g.length)||0,_=()=>{n(t),p()};if(c.useEffect(()=>{m.current[r]=u.current},[r,m]),c.useEffect(()=>{const i=u.current;if(!i)return;const f=I=>{I.forEach(y=>{if(y.isIntersecting){const j=y.target;j.classList.add("animate__fadeInUp","animate__animated");const b=(M,k)=>{const x=j.querySelector(M);x&&(x.style.animationDuration="2s",x.classList.add(k,"animate__animated"))};b("#aaa","animate__fadeInRight"),b("#bbb","animate__fadeInLeft")}})},h=new IntersectionObserver(f,{rootMargin:"0px",threshold:.2});return h.observe(i),()=>h.disconnect()},[]),r===0)return e.jsx("div",{className:a.header,style:{minHeight:"30vh",...l},children:"å¹¿å‘Šä½æ‹›ç§Ÿ"});const s={...l,top:l.top+r*30+window.innerHeight*.3-120};return e.jsx("div",{ref:u,className:a.postCard,style:s,children:e.jsxs("div",{className:a.postContent,onClick:i=>{["ant-image-mask","ant-image-preview-img","ant-image-preview-wrap","ant-image-mask-info"].includes(i.target.className)||_()},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{className:a.username,id:"aaa",children:[(t==null?void 0:t.images.length)>0?"ðŸ¤³ðŸ½":"ðŸ““",(t==null?void 0:t.title)||"Muliminty"]}),e.jsx("div",{style:{minHeight:v>0?60:50,overflowY:"hidden"},id:"bbb",children:e.jsx("div",{style:{height:35,overflowY:"hidden"},children:e.jsx(R,{data:t==null?void 0:t.content})})})]}),e.jsx("div",{className:a.timestamp,children:e.jsx("div",{children:t==null?void 0:t.date})})]})})};U.propTypes={};N.propTypes={index:d.number.isRequired,style:d.object.isRequired,posts:d.array.isRequired,itemRefs:d.object.isRequired,setSelectedPost:d.func.isRequired,showDrawer:d.func.isRequired};export{U as default};
